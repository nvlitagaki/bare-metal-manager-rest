# SPDX-FileCopyrightText: Copyright (c) 2021-2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: LicenseRef-NvidiaProprietary
#
# NVIDIA CORPORATION, its affiliates and licensors retain all intellectual
# property and proprietary rights in and to this material, related
# documentation and any modifications thereto. Any use, reproduction,
# disclosure or distribution of this material and related documentation
# without an express license agreement from NVIDIA CORPORATION or
# its affiliates is strictly prohibited.

# Kustomize base configuration for Carbide REST services
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: carbide

resources:
  # Namespace
  - namespace.yaml
  
  # CRDs (applied separately in kind-up, but included for reference)
  # - crds/site-crd.yaml
  
  # Infrastructure
  - postgres/statefulset.yaml
  - postgres/service.yaml
  - postgres/init-configmap.yaml
  - postgres/adminer.yaml
  
  # Temporal deployed via Helm chart (see Makefile:kind-reset)
  # Temporal certificates applied separately via temporal-helm kustomization
  # Temporal client certificate (for services in carbide namespace)
  - temporal/temporal-client-cert.yaml
  - keycloak/deployment.yaml
  - keycloak/service.yaml
  - keycloak/realm-configmap.yaml
  
  # Secrets
  - secrets/secrets.yaml
  
  # Database migrations (Job)
  - db-migrations/job.yaml
  
  # Application services
  - api/deployment.yaml
  - api/service.yaml
  - api/configmap.yaml
  - workflow/deployment.yaml
  - workflow/configmap.yaml
  - elektraserver/deployment.yaml
  - elektraserver/service.yaml
  - site-agent/deployment.yaml
  - site-agent/service.yaml
  - site-agent/configmap.yaml
  - site-agent/secret.yaml
  - site-agent/certificate.yaml
  - cert-manager/deployment.yaml
  - cert-manager/service.yaml
  - cert-manager/rbac.yaml
  - site-manager/deployment.yaml
  - site-manager/service.yaml
  - site-manager/rbac.yaml
  - site-manager/certificate.yaml

commonLabels:
  app.kubernetes.io/part-of: carbide-rest

